{% extends 'base.html.twig' %}

{% block stylesheets %}
    <link rel="stylesheet" href="{{asset('styles/sortie.css')}}">
{% endblock %}

{% block body %}

<div class="user-container">
    <p>Date du jour : {{"now"|date("d/m/Y")}}</p>
    <p>Participant : {{user.prenom}} {{user.nom|first}}.</p>
</div>

<h2 class="subtitle">Filtrer les sorties</h2>

{{ form_start(form) }}
    <div class="first-column">
        <div class="site-option-container">
            {{form_label(form.sites)}}
            {{form_widget(form.sites)}}
        </div>
        <div class="name-option-container">
            {{form_label(form.nameSearch)}}
            {{form_widget(form.nameSearch)}}
        </div>
        <div class="date-option-container">
            {{form_label(form.dateStart)}}
            {{form_widget(form.dateStart)}}
            {{form_label(form.dateEnd)}}
            {{form_widget(form.dateEnd)}}
        </div>
    </div>
    <div class="second-column">
        <div class="checkbox-container">
            <div class="input-container">
                {{form_label(form.checkboxOrganizer)}}
                {{form_widget(form.checkboxOrganizer)}}
            </div>
            <div class="input-container">            
                {{form_label(form.checkboxRegistered)}}
                {{form_widget(form.checkboxRegistered)}}
            </div>
            <div class="input-container">
                {{form_label(form.checkboxNotRegistered)}}
                {{form_widget(form.checkboxNotRegistered)}}
            </div>
            <div class="input-container">
                {{form_label(form.checkboxPast)}}
                {{form_widget(form.checkboxPast)}}
            </div>
        </div>
    </div>

    <div class="submit-container">
        {{form_widget(form.filter)}}
    </div>
{{ form_end(form) }}

<div class="sortie-container">
    <table>
    <thead>
        <tr>
            <th>Nom de la sortie</th>
            <th>Date de la sortie</th>
            <th>Clôture</th>
            <th>Inscrits/Places</th>
            <th>Etat</th>
            <th>Inscrit</th>
            <th>Organisateur</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for sortie in sorties %}
            <tr>
                <td>{{sortie.nom}}</td>
                <td>{{sortie.dateHeureDebut|date('d-m-Y')}}</td>
                <td>{{sortie.dateLimiteInscription|date('d-m-Y')}}</td>
                <td>{{sortie.participants|length}} / {{sortie.nbInscriptionsMax}}</td>
                <td>{{sortie.etat.libelle}}</td>
                <td>
                {% if user in sortie.participants %}
                    X
                {% endif %}
                </td>
                <td>{{sortie.organisateur.pseudo}}</td>
                <td><a href="{{ path('app_sortie_show', {id: sortie.id}) }}">Afficher</a></td>
            </tr>
        {%endfor%}
    </tbody>
    </table>
</div>

<a class="button" href="{{ path('app_sortie_new') }}">Créer une sortie</a>
{% endblock %}
